\documentclass[handout]{beamer}
% \documentclass{beamer}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{amsmath, amsthm, amsfonts, amssymb}
\usepackage{mathrsfs}

\usetheme{Madrid}
\usecolortheme{default}

\title{Applications of Compactness}
\author{Alexander Mayorov}
\institute{TU Kaiserslautern}

\def\N{\mathbb{N}_{\ge 0}}
\def\Npos{\mathbb{N}_{\ge 1}}
\def\N{\mathbb{N}_{\ge 0}}
\def\R{\mathbb{R}}
\def\Z{\mathbb{Z}}
\def\Q{\mathbb{Q}}
\def\P{\mathcal{P}}

\DeclareMathOperator{\FO}{FO}

\makeatletter
\newenvironment<>{proofs}[1][\proofname]{%
	\par
	\def\insertproofname{#1\@addpunct{.}}%
	\usebeamertemplate{proof begin}#2}
{\usebeamertemplate{proof end}}
\makeatother

\begin{document}
	
\frame{\titlepage}

\begin{frame}
	\frametitle{The compactness theorem}
	\begin{theorem}[Compactness for propositional logic]
		A set of propositional formulas $ \Sigma $ is satisfiable if and only if every finite subset of $ \Sigma $ is satisfiable.
	\end{theorem}
	\begin{proof}
		($ \Rightarrow $): If there exists $ \nu \models \Sigma $, then $ \nu $ will satisfy every finite subset of $ \Sigma $.
		
		($ \Leftarrow $): this direction is rather tricky, see lecture notes
	\end{proof}

	\pause

	\begin{theorem}[Contrapositive form of compactness]
		$ \Sigma $ is unsatisfiable if and only if there is some finite unsatisfiable subset in $ \Sigma $
	\end{theorem}
\end{frame}

\begin{frame}
	\begin{theorem}[Compactness for first order logic]
		A set of closed first order logic formulas $ \Sigma $ is satisfiable if and only if every finite subset of $ \Sigma $ is satisfiable.
	\end{theorem}
	\pause
	\begin{proof}
		($ \Rightarrow $): A model for $ \Sigma $ is also a model for every finite subset thereof.
		
		($ \Leftarrow $): We can assume without loss of generality that all $ \varphi \in \Sigma $ are Skolem normal form sentences with matrix in CNF (via Tseitin's transformation). Suppose, for a sake of contradiction, $ \Sigma $ were unsatisfiable. Since $ \Sigma $ is satisfiable iff $ E(\Sigma) $ is satisfiable by the GÃ¶del-Herbrand-Skolem theorem, we conclude that $ E(\Sigma) $ is unsatisfiable. By the \alert{compactness theorem for propositional logic}, there must exist some finite unsatisfiable subset $ A \subseteq E(\Sigma) $. Taking formulas from $ \Sigma $ whose ground terms appear in $ A $ gives us a finite unsatisfiable subset of $ \Sigma $.
	\end{proof}
\end{frame}

\begin{frame}
	\frametitle{Strategy for proving non-expressibility results}
	Suppose we want to show that some \alert{property $ P $ is not expressible} in first order logic. Then we can try proving it using the following proof schema:
	\begin{itemize}[<+->]
		\item Assume, for a sake of contradiction, that there exists a formula $ \varphi $ expressing $ P $.
		\item Construct an infinite set of formulas $ \{\lambda_k \mid k \in \N\} $ that describes the negation of $ P $.
		\item Consider the set $ C = \{\varphi\} \cup \{\lambda_k \mid k \in \N\} $.
		\item Conclude that $ C $ is unsatisfiable since every model of $ \varphi $ cannot be a model of $ \{\lambda_k \mid k \in \N\} $.
		\item Show that, on the other hand, for every finite $ M \subseteq C $, there is a model with property $ P $.
		\item Conclude that, by compactness, $ C $ is satisfiable, meaning that we get a contradiction.
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Finiteness is not first-order definable}
	\begin{theorem}
		There is no formula $ \varphi $ that is satisfied by structure $ A $ iff $ A $ is finite.
	\end{theorem}
	\pause
	\begin{proofs}
		\begin{itemize}[<+->]
			\item Suppose there were such a formula $ \varphi $.
			\item We describe infiniteness with $ \{\lambda_k \mid k \in \N\} $ where \[\lambda_k := \underbrace{\exists x_1, \dots, x_k : \bigwedge_{i \neq j} x_i \neq x_j}_{\text{Universe has } \ge k \text{ elements}}\]
			\item \[
				C := \underbrace{\underbrace{\{\varphi\}}_{\text{Finite model}} \cup \quad \underbrace{\{\lambda_k \mid k \in \N\}}_{\infty \text{ model}}}_{\Rightarrow \text{ unsatisfiable}}
			\]
		\end{itemize}
	\end{proofs}
\end{frame}

\begin{frame}
	\frametitle{Finiteness is not first-order definable}
	\begin{proof}[\proofname\ (continued)]
		\begin{itemize}[<+->]
			\item Consider an arbitrary but finite $ M \subseteq C $ where, as we just defined, \[
			C = \underbrace{\{\varphi\}}_{\text{Finite model}} \cup \quad \underbrace{\{\lambda_k \mid k \in \N\}}_{\infty \text{ model}}
			\] Since $ M $ is finite, we can find a $ k \in \N $ such that $ M $ does not contain any $ \lambda_i $ for $ i \ge k $. Any structure with at least $ k $ elements thus satisfies $ M $.
			\item By compactness, $ C $ is therefore satisfiable. However, $ C $ is unsatisfiable as we argued on the previous slide. This is a contradiction.
		\end{itemize}
	\end{proof}
\end{frame}

\begin{frame}
	\frametitle{Acyclicity is not first-order definable}
	\begin{theorem}
		Let $ \sigma = \{E_{/2}\} $ be a signature, where $ E $ is the predicate symbol representing the edge relation. There is no $ \varphi \in \FO(\sigma) $ expressing the fact that the graph is acyclic.
	\end{theorem}
	\pause
	\begin{proofs}[\proofname\ attempt (incorrect)]
		\begin{itemize}
			\item Suppose there were such a formula $ \varphi $. We describe the existence of some cycle with $ \{\lambda_k \mid k \in \Npos\} $ where \[\lambda_k := \underbrace{\exists x_1, \dots, x_k : \bigwedge_{\substack{i,j = 1 \\ i \neq j}}^k x_i \neq x_j \wedge \bigwedge_{i=1}^{k-1} E(x_i, x_{i+1}) \wedge E(x_k, x_1)}_{\text{There is a cycle of length } k}\]
		\end{itemize}
	\end{proofs}
\end{frame}

\begin{frame}
	\begin{proofs}[\proofname\ attempt (incorrect) - continued]
		\begin{itemize}
			\item \[
			C := \underbrace{\underbrace{\{\varphi\}}_{\text{Graph acyclic}} \cup \quad \underbrace{\{\lambda_k \mid k \in \Npos\}}_{\text{There is a cycle}}}_{\Rightarrow \text{ unsatisfiable}}
			\]
			\item Consider some finite subset $ M \subseteq C $
			\item \alert{Problem}: $ M $ may contain $ \varphi $ and some $ \lambda_i $-formulas, we cannot however construct a graph that is both acyclic and has a cycle of some specific length.
		\end{itemize}
	\end{proofs}

	\pause

	\textbf{Important conclusion}: in order for this proof technique to work, we need to ``approximate'' the negation of $ P $ using $ \{\lambda_k \mid k \in \Npos\} $ in a way, such that a finite subset of $ \{\lambda_k \mid k \in \Npos\} $ doesn't directly contradict $ \varphi $.
	
	\textbf{In this example}: we cannot ``approximate'' existence of cycles without contradicting acyclicity, because we have to state the existence of a cycle of a certain length with a formula and this directly contradicts acyclicity.
\end{frame}

\begin{frame}
	\frametitle{Acyclicity is not first-order definable}
	
	\textbf{Trick}: we can instead prove that the negation of acyclicity, namely the existence of a cycle, is not first-order definable. This will prove the initial theorem, because \alert{some property is first-order definable iff its negation is first-order definable}.
	
	\begin{theorem}[Equivalent to previous Theorem]
		Let $ \sigma = \{E_{/2}\} $ be a signature, where $ E $ is the predicate symbol representing the edge relation. There is no $ \varphi \in \FO(\sigma) $ expressing the fact that the graph contains a cycle.
	\end{theorem}
\end{frame}

\begin{frame}
	\begin{proof}
		\begin{itemize}
			\item Suppose there were such a formula $ \varphi $. We define \[\lambda_k := \underbrace{\neg \exists x_1, \dots, x_k : \bigwedge_{\substack{i,j = 1 \\ i \neq j}}^k x_i \neq x_j \wedge \bigwedge_{i=1}^{k-1} E(x_i, x_{i+1}) \wedge E(x_k, x_1)}_{\text{There is no cycle of length } k}\]\[
			C := \underbrace{\underbrace{\{\varphi\}}_{\exists\text{ cycle}} \cup \quad \underbrace{\{\lambda_k \mid k \in \Npos\}}_{\text{There are no cycles}}}_{\Rightarrow \text{ unsatisfiable}}
			\]
			\item Consider an arbitrary but finite $ M \subseteq C $. Since $ M $ is finite, we can find a $ k \in \Npos $ such that $ M $ does not contain any $ \lambda_i $ for $ i \ge k $. We can easily construct a graph with a cycle of length $ k $ and without shorter cycles (how?), meaning that $ M $ is satisfiable.
			\item By compactness, $ C $ is satisfiable, which is a contradiction.
		\end{itemize}
	\end{proof}
\end{frame}

\begin{frame}
	\frametitle{Longest path has odd length is not first-order definable}
	
	\begin{theorem}
	There is no $ \varphi \in \FO(\{E_{/2}\}) $ expressing the property that the longest path in the graph has odd length.
	\end{theorem}
	\pause
	\begin{proofs}
		\begin{itemize}
			\item Suppose there were such a formula $ \varphi $. We describe the property that \alert{the longest path is of even or infinite length} with $ \{\lambda_{2n+1} \mid n \in \N\} $: \begin{align*}
				\psi_k &:= \underbrace{\exists x_1, \dots, x_{k+1} : \bigwedge_{\substack{i,j = 1 \\ i \neq j}}^{k+1} x_i \neq x_j \wedge \bigwedge_{i=1}^k E(x_i, x_{i+1})}_{\text{There exists a path of length } k} \\
				\lambda_k &:= \neg(\underbrace{\psi_k \wedge \neg\psi_{k+1}}_{\text{Length of longest path } = k}) \equiv \neg\psi_k \vee \psi_{k+1}
			\end{align*}
		\end{itemize}
	\end{proofs}
\end{frame}

\begin{frame}
	\begin{proof}[\proofname\ (continued)]
		\begin{itemize}
			\item \[
			C := \underbrace{\underbrace{\{\varphi\}}_{\text{Longest path is of odd length}} \cup \underbrace{\{\lambda_{2n+1} \mid n \in \N\}}_{\text{Longest path is of even or infinite length}}}_{\Rightarrow \text{ unsatisfiable}}
			\]
			\item Consider an arbitrary but finite $ M \subseteq C $. Since $ M $ is finite, we can find a $ k \in \N $ such that $ M $ doesn't contain any $ \lambda_i $ for $ i \ge k $. Let $ k' \ge k $ be some odd number. Any finite graph with length of longest path equal $ k' $ is a model for $ M $.
			\item It follows that, by compactness, $ C $ is satisfiable. At the same time, $ C $ is unsatisfiable as we argued above. This is a contradiction.
		\end{itemize}
	\end{proof}
\end{frame}

\end{document}